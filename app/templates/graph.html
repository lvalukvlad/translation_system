<!DOCTYPE html>
<html>
<head>
  <title>Граф знаний</title>
  <link rel="icon" href=",">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <style>
    .graph-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    .graph-node {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      border: 2px solid #667eea;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .graph-node h3 {
      color: #667eea;
      margin-top: 0;
      border-bottom: 2px solid #667eea;
      padding-bottom: 5px;
    }
    .translation-item {
      background: white;
      padding: 10px;
      margin: 8px 0;
      border-radius: 5px;
      border-left: 3px solid #667eea;
    }
    .translation-item strong {
      color: #764ba2;
    }
    .stats {
      background: #e8f4fd;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 5px solid #667eea;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Граф знаний системы перевода</h1>
    
    <div class="stats">
      <h2>Статистика</h2>
      <p><strong>Всего узлов (слов/фраз):</strong> {{ graph|length if graph else 0 }}</p>
      <p><strong>Языковые пары:</strong> 
        {% set langs = [] %}
        {% for word, translations in (graph.items() if graph else []) %}
          {% for trans, data in (translations.items() if translations else []) %}
            {% if 'ru' not in langs %}{% set _ = langs.append('ru') %}{% endif %}
            {% if 'en' not in langs %}{% set _ = langs.append('en') %}{% endif %}
          {% endfor %}
        {% endfor %}
        {{ langs|join(', ') if langs else 'ru → en' }}
      </p>
    </div>

    <div class="graph-container">
      {% if graph %}
        {% for word, translations in graph.items() %}
          {% if translations %}
          <div class="graph-node">
            <h3>{{ word }}</h3>
            {% for trans, data in translations.items() %}
              <div class="translation-item">
                <strong>→ {{ trans }}</strong>
                <br>
                <small style="color: #666;">
                  Вес: {{ data.weight if data.weight else 0.8 }} | 
                  Контекстов: {{ data.contexts|length if data.contexts else 0 }}
                </small>
              </div>
            {% endfor %}
          </div>
          {% endif %}
        {% endfor %}
      {% else %}
        <p>Граф знаний пуст. Загрузите датасет для построения графа.</p>
      {% endif %}
    </div>

    <a href="/dashboard">← Назад к панели управления</a>
  </div>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>